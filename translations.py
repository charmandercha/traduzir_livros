translations = {
    "en": {
        # --- UI Elements ---
        "app_title": "## 📖 EPUB Translator with Ollama",
        "app_subtitle": "Upload an EPUB, select model, languages, and chapters, then translate using a local Ollama model.",
        
        "section_1_title": "### 1. Upload & Configure EPUB",
        "upload_button_text": "Click to Upload EPUB",
        
        "section_2_title": "### 2. Translation Settings",
        "model_name_label": "Ollama Model Name",
        "model_name_placeholder": "e.g., llama3, mistral",
        "from_language_label": "From Language",
        "to_language_label": "To Language",

        "chapters_accordion_label": "Choose chapters to translate (default = all)",
        "section_3_title": "### 3. Select Chapters for Translation",
        "deselect_all_btn": "Deselect All Chapters",
        "select_all_btn": "Select All Chapters",
        "chapters_selector_label": "Chapters to Translate",
        
        "details_accordion_label": "Details about the book",
        "book_title_label": "Book Title",
        "book_author_label": "Book Author",
        "epub_structure_info_label": "EPUB Structure Info",

        "section_4_title": "### 4. Translate & Download",
        "translate_button_text": "🌍 Translate Selected Chapters",
        "download_label": "Download Translated EPUB",
        
        # --- Dynamic & Status Messages ---
        "chapters_selector_label_count": "Chapters to Translate ({num_chapters} found)",
        "epub_structure_info_value": "{num_chapters} chapter documents found in the EPUB.",
        "progress_starting": "Starting translation...",
        "progress_translating_chapter": "Translating Ch. {i}/{total} ('{name}')...",
        "progress_complete": "Translation complete! Finalizing EPUB...",
        "no_chapters_found": "No Chapters Found",

        # --- Notifications (Info, Warning, Error) ---
        "info_lang_detected": "Auto-detected source language for translation as: {lang}",
        "info_lang_detection_failed": "Could not robustly auto-detect source language from EPUB content. Assuming '{lang}'.",
        "info_lang_not_enough_text": "Not enough text in EPUB to auto-detect source language. Assuming '{lang}'.",
        "info_translation_successful": "EPUB translation successful!",
        
        "warning_no_chapters_selected": "No chapters selected for translation. Nothing to do.",
        "warning_upload_epub_first": "Please upload an EPUB file first.",
        "warning_mime_type": "Uploaded file MIME type ({file_type}) is not 'application/epub+zip'. Processing will continue but may fail.",
        "warning_language_detection_failed": "Language detection failed: {error_type}. Defaulting to 'Auto-Detect'.",
        
        "error_no_epub_uploaded": "Please upload an EPUB file first.",
        "error_no_model": "Please enter or select an Ollama model name.",
        "error_epub_size_exceeded": "EPUB file size ({file_size_mb:.2f} MB) exceeds the limit of {max_size} MB.",
        "error_reading_epub": "Error reading EPUB file: {error}. It might be corrupted or not a valid EPUB.",
        "error_ollama_connection": "Failed to connect to Ollama server at {url}. Error: {error_type} - {error}",
        "error_no_valid_chapters": "No valid chapters selected or found for processing.",
        "error_unexpected": "An unexpected error occurred: {error_type} - {error}",
    },
    "pt": {
    # --- UI Elements ---
    "app_title": "## 📖 Tradutor de EPUB com Ollama",
    "app_subtitle": "Faça upload de um EPUB, selecione modelo, idiomas e capítulos, e então traduza usando um modelo Ollama local.",
    
    "section_1_title": "### 1. Carregar & Configurar EPUB",
    "upload_button_text": "Clique para Fazer Upload do EPUB",
    
    "section_2_title": "### 2. Configurações de Tradução",
    "model_name_label": "Nome do Modelo Ollama",
    "model_name_placeholder": "ex.: llama3, mistral",
    "from_language_label": "Idioma de Origem",
    "to_language_label": "Idioma de Destino",

    "chapters_accordion_label": "Escolha os capítulos a serem traduzidos (padrão = todos)",
    "section_3_title": "### 3. Selecione Capítulos para Tradução",
    "deselect_all_btn": "Desmarcar Todos os Capítulos",
    "select_all_btn": "Marcar Todos os Capítulos",
    "chapters_selector_label": "Capítulos a Serem Traduzidos",
    
    "details_accordion_label": "Detalhes sobre o livro",
    "book_title_label": "Título do Livro",
    "book_author_label": "Autor do Livro",
    "epub_structure_info_label": "Informações sobre a Estrutura do EPUB",

    "section_4_title": "### 4. Traduzir & Baixar",
    "translate_button_text": "🌍 Traduzir Capítulos Selecionados",
    "download_label": "Baixar EPUB Traduzido",
    
    # --- Dynamic & Status Messages ---
    "chapters_selector_label_count": "Capítulos a Serem Traduzidos ({num_chapters} encontrados)",
    "epub_structure_info_value": "{num_chapters} documentos de capítulo encontrados no EPUB.",
    "progress_starting": "Iniciando tradução...",
    "progress_translating_chapter": "Traduzindo Cap. {i}/{total} ('{name}')...",
    "progress_complete": "Tradução concluída! Finalizando EPUB...",
    "no_chapters_found": "Nenhum Capítulo Encontrado",

    # --- Notifications (Info, Warning, Error) ---
    "info_lang_detected": "Idioma de origem detectado automaticamente: {lang}",
    "info_lang_detection_failed": "Não foi possível detectar automaticamente o idioma de origem do EPUB. Assumindo '{lang}'.",
    "info_lang_not_enough_text": "Texto insuficiente no EPUB para detectar automaticamente o idioma de origem. Assumindo '{lang}'.",
    "info_translation_successful": "Tradução do EPUB concluída com sucesso!",
    
    "warning_no_chapters_selected": "Nenhum capítulo selecionado para tradução. Nada a fazer.",
    "warning_upload_epub_first": "Por favor, faça o upload de um arquivo EPUB primeiro.",
    "warning_mime_type": "Tipo MIME do arquivo enviado ({file_type}) não é 'application/epub+zip'. O processamento continuará, mas pode falhar.",
    "warning_language_detection_failed": "Falha na detecção do idioma: {error_type}. Usando 'Auto-Detectar' como padrão.",
    
    "error_no_epub_uploaded": "Por favor, faça o upload de um arquivo EPUB primeiro.",
    "error_no_model": "Por favor, insira ou selecione um nome de modelo Ollama.",
    "error_epub_size_exceeded": "O tamanho do arquivo EPUB ({file_size_mb:.2f} MB) excede o limite de {max_size} MB.",
    "error_reading_epub": "Erro ao ler o arquivo EPUB: {error}. Pode estar corrompido ou não ser um EPUB válido.",
    "error_ollama_connection": "Falha ao conectar ao servidor Ollama em {url}. Erro: {error_type} - {error}",
    "error_no_valid_chapters": "Nenhum capítulo válido selecionado ou encontrado para processamento.",
    "error_unexpected": "Ocorreu um erro inesperado: {error_type} - {error}",
},
 "zh": {
        "app_title": "## 📖 使用 Ollama 的 EPUB 翻译器",
        "app_subtitle": "上传 EPUB，选择模型、语言和章节，然后使用本地 Ollama 模型进行翻译。",
        "section_1_title": "### 1. 上传并配置 EPUB",
        "upload_button_text": "点击上传 EPUB",
        "section_2_title": "### 2. 翻译设置",
        "model_name_label": "Ollama 模型名称",
        "model_name_placeholder": "例如：llama3, mistral",
        "from_language_label": "源语言",
        "to_language_label": "目标语言",
        "chapters_accordion_label": "选择要翻译的章节（默认 = 全部）",
        "section_3_title": "### 3. 选择要翻译的章节",
        "deselect_all_btn": "取消选择所有章节",
        "select_all_btn": "选择所有章节",
        "chapters_selector_label": "要翻译的章节",
        "details_accordion_label": "书籍详情",
        "book_title_label": "书名",
        "book_author_label": "作者",
        "epub_structure_info_label": "EPUB 结构信息",
        "section_4_title": "### 4. 翻译并下载",
        "translate_button_text": "🌍 翻译所选章节",
        "download_label": "下载翻译后的 EPUB",
        "chapters_selector_label_count": "要翻译的章节（共找到 {num_chapters} 个）",
        "epub_structure_info_value": "EPUB 中找到 {num_chapters} 个章节文档。",
        "progress_starting": "开始翻译...",
        "progress_translating_chapter": "正在翻译第 {i}/{total} 章（'{name}'）...",
        "progress_complete": "翻译完成！正在生成 EPUB...",
        "no_chapters_found": "未找到章节",
        "info_lang_detected": "自动检测到的源语言为：{lang}",
        "info_lang_detection_failed": "无法可靠地检测源语言，假定为“{lang}”。",
        "info_lang_not_enough_text": "EPUB 中文本不足，假定源语言为“{lang}”。",
        "info_translation_successful": "EPUB 翻译成功！",
        "warning_no_chapters_selected": "未选择任何章节进行翻译。",
        "warning_upload_epub_first": "请先上传 EPUB 文件。",
        "warning_mime_type": "上传的文件类型（{file_type}）不是 'application/epub+zip'，可能会处理失败。",
        "warning_language_detection_failed": "语言检测失败：{error_type}，使用“自动检测”。",
        "error_no_epub_uploaded": "请先上传 EPUB 文件。",
        "error_no_model": "请输入或选择一个 Ollama 模型名称。",
        "error_epub_size_exceeded": "EPUB 文件大小（{file_size_mb:.2f} MB）超出限制（{max_size} MB）。",
        "error_reading_epub": "读取 EPUB 文件时出错：{error}，可能已损坏或不是有效 EPUB。",
        "error_ollama_connection": "连接 Ollama 服务器失败（{url}）：{error_type} - {error}",
        "error_no_valid_chapters": "未找到可处理的有效章节。",
        "error_unexpected": "发生意外错误：{error_type} - {error}",
    },

    "es": {
        "app_title": "## 📖 Traductor EPUB con Ollama",
        "app_subtitle": "Sube un EPUB, selecciona modelo, idiomas y capítulos, y traduce usando un modelo local de Ollama.",
        "section_1_title": "### 1. Subir y Configurar EPUB",
        "upload_button_text": "Haz clic para subir EPUB",
        "section_2_title": "### 2. Configuración de Traducción",
        "model_name_label": "Nombre del Modelo Ollama",
        "model_name_placeholder": "p. ej., llama3, mistral",
        "from_language_label": "Idioma de Origen",
        "to_language_label": "Idioma de Destino",
        "chapters_accordion_label": "Elegir capítulos para traducir (por defecto = todos)",
        "section_3_title": "### 3. Selecciona Capítulos a Traducir",
        "deselect_all_btn": "Deseleccionar Todos",
        "select_all_btn": "Seleccionar Todos",
        "chapters_selector_label": "Capítulos para Traducir",
        "details_accordion_label": "Detalles del libro",
        "book_title_label": "Título del Libro",
        "book_author_label": "Autor del Libro",
        "epub_structure_info_label": "Información de la Estructura del EPUB",
        "section_4_title": "### 4. Traducir y Descargar",
        "translate_button_text": "🌍 Traducir Capítulos Seleccionados",
        "download_label": "Descargar EPUB Traducido",
        "chapters_selector_label_count": "Capítulos para traducir ({num_chapters} encontrados)",
        "epub_structure_info_value": "{num_chapters} documentos de capítulo encontrados en el EPUB.",
        "progress_starting": "Iniciando traducción...",
        "progress_translating_chapter": "Traduciendo Cap. {i}/{total} ('{name}')...",
        "progress_complete": "¡Traducción completa! Finalizando EPUB...",
        "no_chapters_found": "No se encontraron capítulos",
        "info_lang_detected": "Idioma detectado automáticamente: {lang}",
        "info_lang_detection_failed": "No se pudo detectar el idioma. Se asume '{lang}'.",
        "info_lang_not_enough_text": "No hay suficiente texto para detectar el idioma. Se asume '{lang}'.",
        "info_translation_successful": "¡EPUB traducido con éxito!",
        "warning_no_chapters_selected": "No hay capítulos seleccionados para traducir.",
        "warning_upload_epub_first": "Primero debes subir un archivo EPUB.",
        "warning_mime_type": "Tipo MIME ({file_type}) no es 'application/epub+zip'. Puede fallar.",
        "warning_language_detection_failed": "Fallo en la detección de idioma: {error_type}. Usando 'Auto-Detectar'.",
        "error_no_epub_uploaded": "Primero debes subir un archivo EPUB.",
        "error_no_model": "Introduce o selecciona un modelo Ollama.",
        "error_epub_size_exceeded": "El archivo EPUB ({file_size_mb:.2f} MB) supera el límite de {max_size} MB.",
        "error_reading_epub": "Error leyendo el archivo EPUB: {error}.",
        "error_ollama_connection": "Error al conectar con Ollama en {url}: {error_type} - {error}",
        "error_no_valid_chapters": "No se encontraron capítulos válidos.",
        "error_unexpected": "Error inesperado: {error_type} - {error}",
    },

    "fr": {
        "app_title": "## 📖 Traducteur EPUB avec Ollama",
        "app_subtitle": "Téléchargez un EPUB, sélectionnez un modèle, des langues et des chapitres, puis traduisez avec un modèle local Ollama.",
        "section_1_title": "### 1. Télécharger & Configurer EPUB",
        "upload_button_text": "Cliquez pour télécharger l'EPUB",
        "section_2_title": "### 2. Paramètres de Traduction",
        "model_name_label": "Nom du Modèle Ollama",
        "model_name_placeholder": "ex. : llama3, mistral",
        "from_language_label": "Langue Source",
        "to_language_label": "Langue Cible",
        "chapters_accordion_label": "Choisir les chapitres à traduire (par défaut = tous)",
        "section_3_title": "### 3. Sélectionner les Chapitres",
        "deselect_all_btn": "Tout désélectionner",
        "select_all_btn": "Tout sélectionner",
        "chapters_selector_label": "Chapitres à traduire",
        "details_accordion_label": "Détails du livre",
        "book_title_label": "Titre du Livre",
        "book_author_label": "Auteur",
        "epub_structure_info_label": "Informations sur la structure EPUB",
        "section_4_title": "### 4. Traduire & Télécharger",
        "translate_button_text": "🌍 Traduire les Chapitres Sélectionnés",
        "download_label": "Télécharger l'EPUB traduit",
        "chapters_selector_label_count": "Chapitres à traduire ({num_chapters} trouvés)",
        "epub_structure_info_value": "{num_chapters} chapitres trouvés dans l’EPUB.",
        "progress_starting": "Démarrage de la traduction...",
        "progress_translating_chapter": "Traduction Chap. {i}/{total} ('{name}')...",
        "progress_complete": "Traduction terminée ! Finalisation de l’EPUB...",
        "no_chapters_found": "Aucun chapitre trouvé",
        "info_lang_detected": "Langue détectée automatiquement : {lang}",
        "info_lang_detection_failed": "Détection impossible. Langue supposée : '{lang}'",
        "info_lang_not_enough_text": "Pas assez de texte pour détecter la langue. Supposée : '{lang}'",
        "info_translation_successful": "Traduction EPUB réussie !",
        "warning_no_chapters_selected": "Aucun chapitre sélectionné.",
        "warning_upload_epub_first": "Veuillez d'abord téléverser un fichier EPUB.",
        "warning_mime_type": "Type MIME ({file_type}) incorrect. Cela peut échouer.",
        "warning_language_detection_failed": "Échec de détection : {error_type}. Par défaut : Auto.",
        "error_no_epub_uploaded": "Veuillez d'abord téléverser un EPUB.",
        "error_no_model": "Veuillez saisir un nom de modèle.",
        "error_epub_size_exceeded": "Taille du fichier EPUB ({file_size_mb:.2f} MB) > {max_size} MB.",
        "error_reading_epub": "Erreur lors de la lecture : {error}.",
        "error_ollama_connection": "Échec de connexion Ollama ({url}) : {error_type} - {error}",
        "error_no_valid_chapters": "Aucun chapitre valide trouvé.",
        "error_unexpected": "Erreur inattendue : {error_type} - {error}",
    },

    "ja": {
        "app_title": "## 📖 Ollama を使った EPUB 翻訳ツール",
        "app_subtitle": "EPUB をアップロードし、モデル・言語・章を選択し、ローカルの Ollama モデルで翻訳します。",
        "section_1_title": "### 1. EPUB のアップロードと設定",
        "upload_button_text": "EPUB をアップロードする",
        "section_2_title": "### 2. 翻訳の設定",
        "model_name_label": "Ollama モデル名",
        "model_name_placeholder": "例：llama3、mistral",
        "from_language_label": "翻訳元言語",
        "to_language_label": "翻訳先言語",
        "chapters_accordion_label": "翻訳する章を選択（デフォルト：すべて）",
        "section_3_title": "### 3. 翻訳する章を選択",
        "deselect_all_btn": "すべての章を選択解除",
        "select_all_btn": "すべての章を選択",
        "chapters_selector_label": "翻訳対象の章",
        "details_accordion_label": "本の詳細",
        "book_title_label": "書名",
        "book_author_label": "著者",
        "epub_structure_info_label": "EPUB 構造情報",
        "section_4_title": "### 4. 翻訳とダウンロード",
        "translate_button_text": "🌍 選択した章を翻訳する",
        "download_label": "翻訳済 EPUB をダウンロード",
        "chapters_selector_label_count": "翻訳対象の章（{num_chapters} 件）",
        "epub_structure_info_value": "EPUB に {num_chapters} 件の章ドキュメントがあります。",
        "progress_starting": "翻訳を開始中...",
        "progress_translating_chapter": "章 {i}/{total}（'{name}'）を翻訳中...",
        "progress_complete": "翻訳が完了しました！ EPUB を最終化中...",
        "no_chapters_found": "章が見つかりません",
        "info_lang_detected": "自動検出された翻訳元言語：{lang}",
        "info_lang_detection_failed": "言語を自動検出できません。'{lang}' を使用します。",
        "info_lang_not_enough_text": "言語自動検出に十分なテキストがありません。'{lang}' を使用します。",
        "info_translation_successful": "EPUB の翻訳が成功しました！",
        "warning_no_chapters_selected": "翻訳する章が選択されていません。",
        "warning_upload_epub_first": "最初に EPUB ファイルをアップロードしてください。",
        "warning_mime_type": "ファイルの MIME タイプ ({file_type}) は 'application/epub+zip' ではありません。続行しますが失敗する可能性があります。",
        "warning_language_detection_failed": "言語の検出に失敗しました：{error_type}。'自動検出' に設定。",
        "error_no_epub_uploaded": "まず EPUB をアップロードしてください。",
        "error_no_model": "モデル名を入力または選択してください。",
        "error_epub_size_exceeded": "EPUB ファイルのサイズ（{file_size_mb:.2f} MB）が上限（{max_size} MB）を超えています。",
        "error_reading_epub": "EPUB ファイルの読み込みエラー：{error}",
        "error_ollama_connection": "Ollama サーバー（{url}）への接続に失敗：{error_type} - {error}",
        "error_no_valid_chapters": "有効な章が見つかりませんでした。",
        "error_unexpected": "予期しないエラーが発生しました：{error_type} - {error}",
    },

    "ru": {
        "app_title": "## 📖 Переводчик EPUB с Ollama",
        "app_subtitle": "Загрузите EPUB, выберите модель, языки и главы, затем переведите с помощью локальной модели Ollama.",
        "section_1_title": "### 1. Загрузка и настройка EPUB",
        "upload_button_text": "Загрузить EPUB",
        "section_2_title": "### 2. Настройки перевода",
        "model_name_label": "Имя модели Ollama",
        "model_name_placeholder": "например: llama3, mistral",
        "from_language_label": "Исходный язык",
        "to_language_label": "Целевой язык",
        "chapters_accordion_label": "Выберите главы для перевода (по умолчанию = все)",
        "section_3_title": "### 3. Выбор глав для перевода",
        "deselect_all_btn": "Снять выбор со всех глав",
        "select_all_btn": "Выбрать все главы",
        "chapters_selector_label": "Главы для перевода",
        "details_accordion_label": "Информация о книге",
        "book_title_label": "Название книги",
        "book_author_label": "Автор",
        "epub_structure_info_label": "Структура EPUB",
        "section_4_title": "### 4. Перевести и скачать",
        "translate_button_text": "🌍 Перевести выбранные главы",
        "download_label": "Скачать переведённый EPUB",
        "chapters_selector_label_count": "Главы для перевода ({num_chapters} найдено)",
        "epub_structure_info_value": "{num_chapters} глав найдено в EPUB.",
        "progress_starting": "Начинаем перевод...",
        "progress_translating_chapter": "Перевод главы {i}/{total} ('{name}')...",
        "progress_complete": "Перевод завершён! Формируем EPUB...",
        "no_chapters_found": "Главы не найдены",
        "info_lang_detected": "Автоопределён исходный язык: {lang}",
        "info_lang_detection_failed": "Не удалось определить язык. Предположительно: '{lang}'",
        "info_lang_not_enough_text": "Недостаточно текста для автоопределения. Язык: '{lang}'",
        "info_translation_successful": "Перевод EPUB завершён успешно!",
        "warning_no_chapters_selected": "Главы не выбраны для перевода.",
        "warning_upload_epub_first": "Пожалуйста, сначала загрузите EPUB.",
        "warning_mime_type": "Тип MIME ({file_type}) не является 'application/epub+zip'. Возможны ошибки.",
        "warning_language_detection_failed": "Ошибка при определении языка: {error_type}. Используем 'Авто'.",
        "error_no_epub_uploaded": "Сначала загрузите файл EPUB.",
        "error_no_model": "Введите или выберите модель Ollama.",
        "error_epub_size_exceeded": "Размер EPUB-файла ({file_size_mb:.2f} MB) превышает лимит {max_size} MB.",
        "error_reading_epub": "Ошибка при чтении EPUB: {error}",
        "error_ollama_connection": "Ошибка соединения с Ollama ({url}): {error_type} - {error}",
        "error_no_valid_chapters": "Нет действительных глав для обработки.",
        "error_unexpected": "Неожиданная ошибка: {error_type} - {error}",
    }
}